import numpy as np
import pandas as pd

# ----------------------------------------
# ① 고객번호 기준 병합 (merge 기본 예시)
# ----------------------------------------
df1 = pd.DataFrame({
    '고객번호': [1001, 1002, 1003, 1004, 1005],
    '이름': ['윤아', '수영', '서현', '효연', '써니']
})

df2 = pd.DataFrame({
    '고객번호': [1001, 1007, 1003, 1004, 1002, 1001],
    '금액': [10000, 20000, 15000, 5000, 100000, 30000]
})

# 기본 병합 (공통 컬럼 자동 기준, 기본은 inner join)
print(pd.merge(df1, df2))

# join 방식별 비교
print(pd.merge(df1, df2, how="inner"))   # 교집합
print()
print(pd.merge(df1, df2, how="outer"))   # 합집합 (NaN 포함)
print()
print(pd.merge(df1, df2, how="left"))    # 왼쪽 기준
print()
print(pd.merge(df1, df2, how="right"))   # 오른쪽 기준
print()
print("------------------------------------")

# ----------------------------------------
# ② 같은 컬럼명(on='고객명') 기준 병합
# ----------------------------------------
df1 = pd.DataFrame({
    '고객명': ['춘향', '춘향', '몽룡'],
    '날짜': ['2021-01-01', '2021-01-02', '2021-01-03'],
    '데이터': ['100', '200', '300']
})

df2 = pd.DataFrame({
    '고객명': ['춘향', '몽룡', '향단'],
    '데이터': ['여자', '남자', '여자'],
    '주소': ['경기', '서울', '부산']
})

# 동일한 컬럼명을 기준으로 병합 (on = '기준 컬럼명')
# '데이터' 컬럼이 겹치므로 suffixes로 구분
df_merge = pd.merge(df1, df2, on='고객명', suffixes=('1', '2'))
print(df_merge)
print("------------------------------------")

# ③ 다른 컬럼명(left_on / right_on) 기준 병합
df1 = pd.DataFrame({
    '이름': ['춘향', '춘향', '몽룡'],
    '날짜': ['2021-01-01', '2021-01-02', '2021-01-03'],
    '데이터': ['100', '200', '300']
})

df2 = pd.DataFrame({
    '성명': ['춘향', '몽룡', '향단'],
    '데이터': ['여자', '남자', '여자'],
    '주소': ['경기', '서울', '부산']
})

# '이름'(df1) ↔ '성명'(df2)을 기준으로 병합
merge_df = pd.merge(df1, df2, left_on='이름', right_on="성명", how="inner")

# ----------------------------------------
# ④ 특정 컬럼만 남기는 3가지 방법
# ----------------------------------------

# (1) drop : 지정한 컬럼 제거
m1_drop = merge_df.drop(columns=['성명', '데이터_x'], inplace=False)
print("1. drop")
print(m1_drop)
print("------------------------------------")

# (2) reindex : 필요한 컬럼만 선택 + 순서 지정 가능
m2_reindex = merge_df.reindex(columns=['이름', '날짜', '데이터_y', '주소'])
print("2. reindex")
print(m2_reindex)
print("------------------------------------")

# (3) 인덱싱 [[]] : 간단히 일부 컬럼만 출력
print("3. 인덱싱")
print(merge_df[['이름', '날짜', '데이터_y', '주소']])

